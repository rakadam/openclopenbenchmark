
//OpenCL
//MAX_GLOBAL_SIZE:-1
//MAX_LOCAL_SIZE:0
//MIN_LOCAL_SIZE:32
//KERNEL_FLAG:KERNEL_FLAG_MORE_LOCAL_SIZES

constant const int quant_table [] = {
10082,6554,10082,6554,6554,4194,6554,4194,10082,6554,10082,6554,6554,4194,6554,4194,10082,6554,10082,6554,6554,4194,6554,4194,10082,6554,10082,6554,6554,4194,6554,4194,10082,6554,10082,6554,6554,4194,6554,4194,10082,6554,10082,6554,6554,4194,6554,4194,10082,6554,10082,6554,6554,4194,6554,4194,10082,6554,10082,6554,6554,4194,6554,4194,                                                                                                                                                              
9362,5825,9362,5825,5825,3647,5825,3647,9362,5825,9362,5825,5825,3647,5825,3647,9362,5825,9362,5825,5825,3647,5825,3647,9362,5825,9362,5825,5825,3647,5825,3647,9362,5825,9362,5825,5825,3647,5825,3647,9362,5825,9362,5825,5825,3647,5825,3647,9362,5825,9362,5825,5825,3647,5825,3647,9362,5825,9362,5825,5825,3647,5825,3647,         
26214,16132,26214,16132,16132,10486,16132,10486,26214,16132,26214,16132,16132,10486,16132,10486,26214,16132,26214,16132,16132,10486,16132,10486,26214,16132,26214,16132,16132,10486,16132,10486,26214,16132,26214,16132,16132,10486,16132,10486,26214,16132,26214,16132,16132,10486,16132,10486,26214,16132,26214,16132,16132,10486,16132,10486,26214,16132,26214,16132,16132,10486,16132,10486,                                                                                                 
23832,14980,23832,14980,14980,9320,14980,9320,23832,14980,23832,14980,14980,9320,14980,9320,23832,14980,23832,14980,14980,9320,14980,9320,23832,14980,23832,14980,14980,9320,14980,9320,23832,14980,23832,14980,14980,9320,14980,9320,23832,14980,23832,14980,14980,9320,14980,9320,23832,14980,23832,14980,14980,9320,14980,9320,23832,14980,23832,14980,14980,9320,14980,9320,                                                                                                                              
20164,13108,20164,13108,13108,8388,13108,8388,20164,13108,20164,13108,13108,8388,13108,8388,20164,13108,20164,13108,13108,8388,13108,8388,20164,13108,20164,13108,13108,8388,13108,8388,20164,13108,20164,13108,13108,8388,13108,8388,20164,13108,20164,13108,13108,8388,13108,8388,20164,13108,20164,13108,13108,8388,13108,8388,20164,13108,20164,13108,13108,8388,13108,8388,                                                                                                                              
18724,11650,18724,11650,11650,7294,11650,7294,18724,11650,18724,11650,11650,7294,11650,7294,18724,11650,18724,11650,11650,7294,11650,7294,18724,11650,18724,11650,11650,7294,11650,7294,18724,11650,18724,11650,11650,7294,11650,7294,18724,11650,18724,11650,11650,7294,11650,7294,18724,11650,18724,11650,11650,7294,11650,7294,18724,11650,18724,11650,11650,7294,11650,7294,                                                                                                                              
16384,10486,16384,10486,10486,6710,10486,6710,16384,10486,16384,10486,10486,6710,10486,6710,16384,10486,16384,10486,10486,6710,10486,6710,16384,10486,16384,10486,10486,6710,10486,6710,16384,10486,16384,10486,10486,6710,10486,6710,16384,10486,16384,10486,10486,6710,10486,6710,16384,10486,16384,10486,10486,6710,10486,6710,16384,10486,16384,10486,10486,6710,10486,6710,                                                                                                                              
14564,9118,14564,9118,9118,5786,9118,5786,14564,9118,14564,9118,9118,5786,9118,5786,14564,9118,14564,9118,9118,5786,9118,5786,14564,9118,14564,9118,9118,5786,9118,5786,14564,9118,14564,9118,9118,5786,9118,5786,14564,9118,14564,9118,9118,5786,9118,5786,14564,9118,14564,9118,9118,5786,9118,5786,14564,9118,14564,9118,9118,5786,9118,5786,                                                                                                                                                              
13107,8066,13107,8066,8066,5243,8066,5243,13107,8066,13107,8066,8066,5243,8066,5243,13107,8066,13107,8066,8066,5243,8066,5243,13107,8066,13107,8066,8066,5243,8066,5243,13107,8066,13107,8066,8066,5243,8066,5243,13107,8066,13107,8066,8066,5243,8066,5243,13107,8066,13107,8066,8066,5243,8066,5243,13107,8066,13107,8066,8066,5243,8066,5243,                                                                                                                                                              
11916,7490,11916,7490,7490,4660,7490,4660,11916,7490,11916,7490,7490,4660,7490,4660,11916,7490,11916,7490,7490,4660,7490,4660,11916,7490,11916,7490,7490,4660,7490,4660,11916,7490,11916,7490,7490,4660,7490,4660,11916,7490,11916,7490,7490,4660,7490,4660,11916,7490,11916,7490,7490,4660,7490,4660,11916,7490,11916,7490,7490,4660,7490,4660,                                                                                                                                                              
4681,2913,4681,2913,2913,1824,2913,1824,4681,2913,4681,2913,2913,1824,2913,1824,4681,2913,4681,2913,2913,1824,2913,1824,4681,2913,4681,2913,2913,1824,2913,1824,4681,2913,4681,2913,2913,1824,2913,1824,4681,2913,4681,2913,2913,1824,2913,1824,4681,2913,4681,2913,2913,1824,2913,1824,4681,2913,4681,2913,2913,1824,2913,1824,         
4096,2622,4096,2622,2622,1678,2622,1678,4096,2622,4096,2622,2622,1678,2622,1678,4096,2622,4096,2622,2622,1678,2622,1678,4096,2622,4096,2622,2622,1678,2622,1678,4096,2622,4096,2622,2622,1678,2622,1678,4096,2622,4096,2622,2622,1678,2622,1678,4096,2622,4096,2622,2622,1678,2622,1678,4096,2622,4096,2622,2622,1678,2622,1678,         
8192,5243,8192,5243,5243,3355,5243,3355,8192,5243,8192,5243,5243,3355,5243,3355,8192,5243,8192,5243,5243,3355,5243,3355,8192,5243,8192,5243,5243,3355,5243,3355,8192,5243,8192,5243,5243,3355,5243,3355,8192,5243,8192,5243,5243,3355,5243,3355,8192,5243,8192,5243,5243,3355,5243,3355,8192,5243,8192,5243,5243,3355,5243,3355,         
7282,4559,7282,4559,4559,2893,4559,2893,7282,4559,7282,4559,4559,2893,4559,2893,7282,4559,7282,4559,4559,2893,4559,2893,7282,4559,7282,4559,4559,2893,4559,2893,7282,4559,7282,4559,4559,2893,4559,2893,7282,4559,7282,4559,4559,2893,4559,2893,7282,4559,7282,4559,4559,2893,4559,2893,7282,4559,7282,4559,4559,2893,4559,2893,         
6554,4033,6554,4033,4033,2622,4033,2622,6554,4033,6554,4033,4033,2622,4033,2622,6554,4033,6554,4033,4033,2622,4033,2622,6554,4033,6554,4033,4033,2622,4033,2622,6554,4033,6554,4033,4033,2622,4033,2622,6554,4033,6554,4033,4033,2622,4033,2622,6554,4033,6554,4033,4033,2622,4033,2622,6554,4033,6554,4033,4033,2622,4033,2622,         
3277,2017,3277,2017,2017,1311,2017,1311,3277,2017,3277,2017,2017,1311,2017,1311,3277,2017,3277,2017,2017,1311,2017,1311,3277,2017,3277,2017,2017,1311,2017,1311,3277,2017,3277,2017,2017,1311,2017,1311,3277,2017,3277,2017,2017,1311,2017,1311,3277,2017,3277,2017,2017,1311,2017,1311,3277,2017,3277,2017,2017,1311,2017,1311,         
2979,1873,2979,1873,1873,1165,1873,1165,2979,1873,2979,1873,1873,1165,1873,1165,2979,1873,2979,1873,1873,1165,1873,1165,2979,1873,2979,1873,1873,1165,1873,1165,2979,1873,2979,1873,1873,1165,1873,1165,2979,1873,2979,1873,1873,1165,1873,1165,2979,1873,2979,1873,1873,1165,1873,1165,2979,1873,2979,1873,1873,1165,1873,1165,         
5958,3745,5958,3745,3745,2330,3745,2330,5958,3745,5958,3745,3745,2330,3745,2330,5958,3745,5958,3745,3745,2330,3745,2330,5958,3745,5958,3745,3745,2330,3745,2330,5958,3745,5958,3745,3745,2330,3745,2330,5958,3745,5958,3745,3745,2330,3745,2330,5958,3745,5958,3745,3745,2330,3745,2330,5958,3745,5958,3745,3745,2330,3745,2330,         
5041,3277,5041,3277,3277,2097,3277,2097,5041,3277,5041,3277,3277,2097,3277,2097,5041,3277,5041,3277,3277,2097,3277,2097,5041,3277,5041,3277,3277,2097,3277,2097,5041,3277,5041,3277,3277,2097,3277,2097,5041,3277,5041,3277,3277,2097,3277,2097,5041,3277,5041,3277,3277,2097,3277,2097,5041,3277,5041,3277,3277,2097,3277,2097,         
3641,2280,3641,2280,2280,1447,2280,1447,3641,2280,3641,2280,2280,1447,2280,1447,3641,2280,3641,2280,2280,1447,2280,1447,3641,2280,3641,2280,2280,1447,2280,1447,3641,2280,3641,2280,2280,1447,2280,1447,3641,2280,3641,2280,2280,1447,2280,1447,3641,2280,3641,2280,2280,1447,2280,1447,3641,2280,3641,2280,2280,1447,2280,1447,         
1821,1140,1821,1140,1140,723,1140,723,1821,1140,1821,1140,1140,723,1140,723,1821,1140,1821,1140,1140,723,1140,723,1821,1140,1821,1140,1140,723,1140,723,1821,1140,1821,1140,1140,723,1140,723,1821,1140,1821,1140,1140,723,1140,723,1821,1140,1821,1140,1140,723,1140,723,1821,1140,1821,1140,1140,723,1140,723,                         
1638,1008,1638,1008,1008,655,1008,655,1638,1008,1638,1008,1008,655,1008,655,1638,1008,1638,1008,1008,655,1008,655,1638,1008,1638,1008,1008,655,1008,655,1638,1008,1638,1008,1008,655,1008,655,1638,1008,1638,1008,1008,655,1008,655,1638,1008,1638,1008,1008,655,1008,655,1638,1008,1638,1008,1008,655,1008,655,                         
1490,936,1490,936,936,583,936,583,1490,936,1490,936,936,583,936,583,1490,936,1490,936,936,583,936,583,1490,936,1490,936,936,583,936,583,1490,936,1490,936,936,583,936,583,1490,936,1490,936,936,583,936,583,1490,936,1490,936,936,583,936,583,1490,936,1490,936,936,583,936,583,                                                         
2521,1639,2521,1639,1639,1049,1639,1049,2521,1639,2521,1639,1639,1049,1639,1049,2521,1639,2521,1639,1639,1049,1639,1049,2521,1639,2521,1639,1639,1049,1639,1049,2521,1639,2521,1639,1639,1049,1639,1049,2521,1639,2521,1639,1639,1049,1639,1049,2521,1639,2521,1639,1639,1049,1639,1049,2521,1639,2521,1639,1639,1049,1639,1049,         
1170,728,1170,728,728,456,728,456,1170,728,1170,728,728,456,728,456,1170,728,1170,728,728,456,728,456,1170,728,1170,728,728,456,728,456,1170,728,1170,728,728,456,728,456,1170,728,1170,728,728,456,728,456,1170,728,1170,728,728,456,728,456,1170,728,1170,728,728,456,728,456,                                                         
1024,655,1024,655,655,419,655,419,1024,655,1024,655,655,419,655,419,1024,655,1024,655,655,419,655,419,1024,655,1024,655,655,419,655,419,1024,655,1024,655,655,419,655,419,1024,655,1024,655,655,419,655,419,1024,655,1024,655,655,419,655,419,1024,655,1024,655,655,419,655,419,                                                         
2341,1456,2341,1456,1456,912,1456,912,2341,1456,2341,1456,1456,912,1456,912,2341,1456,2341,1456,1456,912,1456,912,2341,1456,2341,1456,1456,912,1456,912,2341,1456,2341,1456,1456,912,1456,912,2341,1456,2341,1456,1456,912,1456,912,2341,1456,2341,1456,1456,912,1456,912,2341,1456,2341,1456,1456,912,1456,912,                         
2048,1311,2048,1311,1311,839,1311,839,2048,1311,2048,1311,1311,839,1311,839,2048,1311,2048,1311,1311,839,1311,839,2048,1311,2048,1311,1311,839,1311,839,2048,1311,2048,1311,1311,839,1311,839,2048,1311,2048,1311,1311,839,1311,839,2048,1311,2048,1311,1311,839,1311,839,2048,1311,2048,1311,1311,839,1311,839,                         
1260,819,1260,819,819,524,819,524,1260,819,1260,819,819,524,819,524,1260,819,1260,819,819,524,819,524,1260,819,1260,819,819,524,819,524,1260,819,1260,819,819,524,819,524,1260,819,1260,819,819,524,819,524,1260,819,1260,819,819,524,819,524,1260,819,1260,819,819,524,819,524,                                                         
0630,410,630,410,410,262,410,262,630,410,630,410,410,262,410,262,630,410,630,410,410,262,410,262,630,410,630,410,410,262,410,262,630,410,630,410,410,262,410,262,630,410,630,410,410,262,410,262,630,410,630,410,410,262,410,262,630,410,630,410,410,262,410,262,                                                                         
585,364,585,364,364,228,364,228,585,364,585,364,364,228,364,228,585,364,585,364,364,228,364,228,585,364,585,364,364,228,364,228,585,364,585,364,364,228,364,228,585,364,585,364,364,228,364,228,585,364,585,364,364,228,364,228,585,364,585,364,364,228,364,228,                                                                         
512,328,512,328,328,210,328,210,512,328,512,328,328,210,328,210,512,328,512,328,328,210,328,210,512,328,512,328,328,210,328,210,512,328,512,328,328,210,328,210,512,328,512,328,328,210,328,210,512,328,512,328,328,210,328,210,512,328,512,328,328,210,328,210,                                                                         
910,570,910,570,570,362,570,362,910,570,910,570,570,362,570,362,910,570,910,570,570,362,570,362,910,570,910,570,570,362,570,362,910,570,910,570,570,362,570,362,910,570,910,570,570,362,570,362,910,570,910,570,570,362,570,362,910,570,910,570,570,362,570,362,                                                                         
819,504,819,504,504,328,504,328,819,504,819,504,504,328,504,328,819,504,819,504,504,328,504,328,819,504,819,504,504,328,504,328,819,504,819,504,504,328,504,328,819,504,819,504,504,328,504,328,819,504,819,504,504,328,504,328,819,504,819,504,504,328,504,328,                                                                         
745,468,745,468,468,291,468,291,745,468,745,468,468,291,468,291,745,468,745,468,468,291,468,291,745,468,745,468,468,291,468,291,745,468,745,468,468,291,468,291,745,468,745,468,468,291,468,291,745,468,745,468,468,291,468,291,745,468,745,468,468,291,468,291,                                                                         
455,285,455,285,285,181,285,181,455,285,455,285,285,181,285,181,455,285,455,285,285,181,285,181,455,285,455,285,285,181,285,181,455,285,455,285,285,181,285,181,455,285,455,285,285,181,285,181,455,285,455,285,285,181,285,181,455,285,455,285,285,181,285,181,                                                                         
410,252,410,252,252,164,252,164,410,252,410,252,252,164,252,164,410,252,410,252,252,164,252,164,410,252,410,252,252,164,252,164,410,252,410,252,252,164,252,164,410,252,410,252,252,164,252,164,410,252,410,252,252,164,252,164,410,252,410,252,252,164,252,164,                                                                         
228,142,228,142,142,90,142,90,228,142,228,142,142,90,142,90,228,142,228,142,142,90,142,90,228,142,228,142,142,90,142,90,228,142,228,142,142,90,142,90,228,142,228,142,142,90,142,90,228,142,228,142,142,90,142,90,228,142,228,142,142,90,142,90,                                                                                         
205,126,205,126,126,82,126,82,205,126,205,126,126,82,126,82,205,126,205,126,126,82,126,82,205,126,205,126,126,82,126,82,205,126,205,126,126,82,126,82,205,126,205,126,126,82,126,82,205,126,205,126,126,82,126,82,205,126,205,126,126,82,126,82,
372,234,372,234,234,146,234,146,372,234,372,234,234,146,234,146,372,234,372,234,234,146,234,146,372,234,372,234,234,146,234,146,372,234,372,234,234,146,234,146,372,234,372,234,234,146,234,146,372,234,372,234,234,146,234,146,372,234,372,234,234,146,234,146,                                                                         
315,205,315,205,205,131,205,131,315,205,315,205,205,131,205,131,315,205,315,205,205,131,205,131,315,205,315,205,205,131,205,131,315,205,315,205,205,131,205,131,315,205,315,205,205,131,205,131,315,205,315,205,205,131,205,131,315,205,315,205,205,131,205,131,                                                                         
293,182,293,182,182,114,182,114,293,182,293,182,182,114,182,114,293,182,293,182,182,114,182,114,293,182,293,182,182,114,182,114,293,182,293,182,182,114,182,114,293,182,293,182,182,114,182,114,293,182,293,182,182,114,182,114,293,182,293,182,182,114,182,114,                                                                         
256,164,256,164,164,105,164,105,256,164,256,164,164,105,164,105,256,164,256,164,164,105,164,105,256,164,256,164,164,105,164,105,256,164,256,164,164,105,164,105,256,164,256,164,164,105,164,105,256,164,256,164,164,105,164,105,256,164,256,164,164,105,164,105,                                                                         
186,117,186,117,117,73,117,73,186,117,186,117,117,73,117,73,186,117,186,117,117,73,117,73,186,117,186,117,117,73,117,73,186,117,186,117,117,73,117,73,186,117,186,117,117,73,117,73,186,117,186,117,117,73,117,73,186,117,186,117,117,73,117,73,
158,102,158,102,102,66,102,66,158,102,158,102,102,66,102,66,158,102,158,102,102,66,102,66,158,102,158,102,102,66,102,66,158,102,158,102,102,66,102,66,158,102,158,102,102,66,102,66,158,102,158,102,102,66,102,66,158,102,158,102,102,66,102,66,
102,63,102,63,63,41,63,41,102,63,102,63,63,41,63,41,102,63,102,63,63,41,63,41,102,63,102,63,63,41,63,41,102,63,102,63,63,41,63,41,102,63,102,63,63,41,63,41,102,63,102,63,63,41,63,41,102,63,102,63,63,41,63,41,
93,59,93,59,59,36,59,36,93,59,93,59,59,36,59,36,93,59,93,59,59,36,59,36,93,59,93,59,59,36,59,36,93,59,93,59,59,36,59,36,93,59,93,59,59,36,59,36,93,59,93,59,59,36,59,36,93,59,93,59,59,36,59,36,
146,91,146,91,91,57,91,57,146,91,146,91,91,57,91,57,146,91,146,91,91,57,91,57,146,91,146,91,91,57,91,57,146,91,146,91,91,57,91,57,146,91,146,91,91,57,91,57,146,91,146,91,91,57,91,57,146,91,146,91,91,57,91,57,
73,46,73,46,46,28,46,28,73,46,73,46,46,28,46,28,73,46,73,46,46,28,46,28,73,46,73,46,46,28,46,28,73,46,73,46,46,28,46,28,73,46,73,46,46,28,46,28,73,46,73,46,46,28,46,28,73,46,73,46,46,28,46,28
128,82,128,82,82,52,82,52,128,82,128,82,82,52,82,52,128,82,128,82,82,52,82,52,128,82,128,82,82,52,82,52,128,82,128,82,82,52,82,52,128,82,128,82,82,52,82,52,128,82,128,82,82,52,82,52,128,82,128,82,82,52,82,52,
79,51,79,51,51,33,51,33,79,51,79,51,51,33,51,33,79,51,79,51,51,33,51,33,79,51,79,51,51,33,51,33,79,51,79,51,51,33,51,33,79,51,79,51,51,33,51,33,79,51,79,51,51,33,51,33,79,51,79,51,51,33,51,33,
114,71,114,71,71,45,71,45,114,71,114,71,71,45,71,45,114,71,114,71,71,45,71,45,114,71,114,71,71,45,71,45,114,71,114,71,71,45,71,45,114,71,114,71,71,45,71,45,114,71,114,71,71,45,71,45,114,71,114,71,71,45,71,45,
};



constant const int dequant_table[] = {
  176,224,224,288,224,288,176,224,176,224,224,288,224,288,176,224,176,224,224,288,224,288,176,224,176,224,224,288,224,288,
  208,256,208,256,176,224,176,224,224,288,224,288,176,224,176,224,224,288,224,288,176,224,176,224,224,288,224,288,176,224,
  256,320,256,320,208,256,208,256,256,320,256,320,224,288,224,288,288,368,288,368,224,288,224,288,288,368,288,368,224,288,
  224,288,224,288,288,368,288,368,224,288,224,288,288,368,288,368,256,320,256,320,320,400,320,400,256,320,256,320,320,400,
  288,368,368,464,368,464,288,368,288,368,368,464,368,464,288,368,288,368,368,464,368,464,288,368,288,368,368,464,368,464,
  320,400,256,320,256,320,320,400,320,400,256,320,256,320,320,400,320,400,256,320,256,320,320,400,320,400,256,320,256,320,
  160,208,160,208,208,256,208,256,160,208,160,208,208,256,208,256,160,208,160,208,208,256,208,256,160,208,160,208,208,256,
  208,256,160,208,160,208,208,256,208,256,160,208,160,208,208,256,208,256,160,208,160,208,208,256,208,256,160,208,160,208,
  224,288,288,368,288,368,224,288,224,288,288,368,288,368,224,288,224,288,288,368,288,368,224,288,224,288,288,368,288,368,
  256,320,208,256,208,256,256,320,256,320,208,256,208,256,256,320,256,320,208,256,208,256,256,320,256,320,208,256,208,256,
  320,400,320,400,256,320,256,320,320,400,320,400,256,320,256,320,320,400,320,400,288,368,288,368,368,464,368,464,288,368,
  176,224,176,224,224,288,224,288,208,256,208,256,256,320,256,320,208,256,208,256,256,320,256,320,208,256,208,256,256,320,
  288,368,288,368,368,464,368,464,288,368,288,368,368,464,368,464,288,368,288,368,368,464,368,464};



constant const int bias_table[] = {
1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,                                    
1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,1,                        
1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,1,                                    
1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,                                    
1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,                                    
2,3,2,3,3,5,3,5,2,3,2,3,3,5,3,5,1,2,1,2,2,2,2,2,1,2,1,2,2,2,2,2,2,3,2,3,3,5,3,5,2,3,2,3,3,5,3,5,1,2,1,2,2,2,2,2,1,2,1,2,2,2,2,2,                                    
2,3,2,3,3,5,3,5,2,3,2,3,3,5,3,5,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,2,3,2,3,3,5,3,5,2,3,2,3,3,5,3,5,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,                                    
2,4,2,4,4,6,4,6,2,4,2,4,4,6,4,6,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,2,4,2,4,4,6,4,6,2,4,2,4,4,6,4,6,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,                                    
1,2,1,2,2,4,2,4,1,2,1,2,2,4,2,4,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,1,2,1,2,2,4,2,4,1,2,1,2,2,4,2,4,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,                                    
2,3,2,3,3,4,3,4,2,3,2,3,3,4,3,4,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,2,3,2,3,3,4,3,4,2,3,2,3,3,4,3,4,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,                                    
3,4,3,4,4,6,4,6,3,4,3,4,4,6,4,6,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,3,4,3,4,4,6,4,6,3,4,3,4,4,6,4,6,1,2,1,2,2,3,2,3,1,2,1,2,2,3,2,3,                                    
3,5,3,5,5,7,5,7,3,5,3,5,5,7,5,7,2,2,2,2,2,4,2,4,2,2,2,2,2,4,2,4,3,5,3,5,5,7,5,7,3,5,3,5,5,7,5,7,2,2,2,2,2,4,2,4,2,2,2,2,2,4,2,4,                                    
5,7,5,7,7,12,7,12,5,7,5,7,7,12,7,12,2,4,2,4,4,6,4,6,2,4,2,4,4,6,4,6,5,7,5,7,7,12,7,12,5,7,5,7,7,12,7,12,2,4,2,4,4,6,4,6,2,4,2,4,4,6,4,6,                            
5,8,5,8,8,13,8,13,5,8,5,8,8,13,8,13,3,4,3,4,4,7,4,7,3,4,3,4,4,7,4,7,5,8,5,8,8,13,8,13,5,8,5,8,8,13,8,13,3,4,3,4,4,7,4,7,3,4,3,4,4,7,4,7,                            
3,5,3,5,5,8,5,8,3,5,3,5,5,8,5,8,2,3,2,3,3,4,3,4,2,3,2,3,3,4,3,4,3,5,3,5,5,8,5,8,3,5,3,5,5,8,5,8,2,3,2,3,3,4,3,4,2,3,2,3,3,4,3,4,                                    
4,6,4,6,6,9,6,9,4,6,4,6,6,9,6,9,2,3,2,3,3,5,3,5,2,3,2,3,3,5,3,5,4,6,4,6,6,9,6,9,4,6,4,6,6,9,6,9,2,3,2,3,3,5,3,5,2,3,2,3,3,5,3,5,                                    
4,7,4,7,7,10,7,10,4,7,4,7,7,10,7,10,2,3,2,3,3,5,3,5,2,3,2,3,3,5,3,5,4,7,4,7,7,10,7,10,4,7,4,7,7,10,7,10,2,3,2,3,3,5,3,5,2,3,2,3,3,5,3,5,                            
6,9,6,9,9,15,9,15,6,9,6,9,9,15,9,15,3,5,3,5,5,8,5,8,3,5,3,5,5,8,5,8,6,9,6,9,9,15,9,15,6,9,6,9,9,15,9,15,3,5,3,5,5,8,5,8,3,5,3,5,5,8,5,8,                            
7,11,7,11,11,16,11,16,7,11,7,11,11,16,11,16,3,6,3,6,6,9,6,9,3,6,3,6,6,9,6,9,7,11,7,11,11,16,11,16,7,11,7,11,11,16,11,16,3,6,3,6,6,9,6,9,3,6,3,6,6,9,6,9,            
11,16,11,16,16,26,16,26,11,16,11,16,16,26,16,26,6,9,6,9,9,13,9,13,6,9,6,9,9,13,9,13,11,16,11,16,16,26,16,26,11,16,11,16,16,26,16,26,6,9,6,9,9,13,9,13,6,9,6,9,9,13,9,13,                                                                                                                                                                 
12,19,12,19,19,30,19,30,12,19,12,19,19,30,19,30,6,10,6,10,10,16,10,16,6,10,6,10,10,16,10,16,12,19,12,19,19,30,19,30,12,19,12,19,19,30,19,30,6,10,6,10,10,16,10,16,6,10,6,10,10,16,10,16,                                                                                                                                                 
7,11,7,11,11,18,11,18,7,11,7,11,11,18,11,18,4,6,4,6,6,10,6,10,4,6,4,6,6,10,6,10,7,11,7,11,11,18,11,18,7,11,7,11,11,18,11,18,4,6,4,6,6,10,6,10,4,6,4,6,6,10,6,10,    
9,13,9,13,13,20,13,20,9,13,9,13,13,20,13,20,4,7,4,7,7,11,7,11,4,7,4,7,7,11,7,11,9,13,9,13,13,20,13,20,9,13,9,13,13,20,13,20,4,7,4,7,7,11,7,11,4,7,4,7,7,11,7,11,    
9,15,9,15,15,24,15,24,9,15,9,15,15,24,15,24,5,8,5,8,8,12,8,12,5,8,5,8,8,12,8,12,9,15,9,15,15,24,15,24,9,15,9,15,15,24,15,24,5,8,5,8,8,12,8,12,5,8,5,8,8,12,8,12,    
13,21,13,21,21,33,21,33,13,21,13,21,21,33,21,33,7,11,7,11,11,17,11,17,7,11,7,11,11,17,11,17,13,21,13,21,21,33,21,33,13,21,13,21,21,33,21,33,7,11,7,11,11,17,11,17,7,11,7,11,11,17,11,17,                                                                                                                                                 
14,23,14,23,23,37,23,37,14,23,14,23,23,37,23,37,8,12,8,12,12,19,12,19,8,12,8,12,12,19,12,19,14,23,14,23,23,37,23,37,14,23,14,23,23,37,23,37,8,12,8,12,12,19,12,19,8,12,8,12,12,19,12,19,                                                                                                                                                 
21,33,21,33,33,51,33,51,21,33,21,33,33,51,33,51,11,17,11,17,17,27,17,27,11,17,11,17,17,27,17,27,21,33,21,33,33,51,33,51,21,33,21,33,33,51,33,51,11,17,11,17,17,27,17,27,11,17,11,17,17,27,17,27,                                                                                                                                         
24,38,24,38,38,59,38,59,24,38,24,38,38,59,38,59,12,20,12,20,20,31,20,31,12,20,12,20,20,31,20,31,24,38,24,38,38,59,38,59,24,38,24,38,38,59,38,59,12,20,12,20,20,31,20,31,12,20,12,20,20,31,20,31,                                                                                                                                         
17,26,17,26,26,41,26,41,17,26,17,26,26,41,26,41,9,14,9,14,14,21,14,21,9,14,9,14,14,21,14,21,17,26,17,26,26,41,26,41,17,26,17,26,26,41,26,41,9,14,9,14,14,21,14,21,9,14,9,14,14,21,14,21,                                                                                                                                                 
18,30,18,30,30,47,30,47,18,30,18,30,30,47,30,47,10,15,10,15,15,25,15,25,10,15,10,15,15,25,15,25,18,30,18,30,30,47,30,47,18,30,18,30,30,47,30,47,10,15,10,15,15,25,15,25,10,15,10,15,15,25,15,25,                                                                                                                                         
34,52,34,52,52,82,52,82,34,52,34,52,52,82,52,82,18,27,18,27,27,43,27,43,18,27,18,27,27,43,27,43,34,52,34,52,52,82,52,82,34,52,34,52,52,82,52,82,18,27,18,27,27,43,27,43,18,27,18,27,27,43,27,43,                                                                                                                                         
37,59,37,59,59,94,59,94,37,59,37,59,59,94,59,94,19,31,19,31,31,49,31,49,19,31,19,31,31,49,31,49,37,59,37,59,59,94,59,94,37,59,37,59,59,94,59,94,19,31,19,31,31,49,31,49,19,31,19,31,31,49,31,49,                                                                                                                                         
42,66,42,66,66,102,66,102,42,66,42,66,66,102,66,102,22,34,22,34,34,54,34,54,22,34,22,34,34,54,34,54,42,66,42,66,66,102,66,102,42,66,42,66,66,102,66,102,22,34,22,34,34,54,34,54,22,34,22,34,34,54,34,54,                                                                                                                                 
26,43,26,43,43,66,43,66,26,43,26,43,43,66,43,66,14,22,14,22,22,34,22,34,14,22,14,22,22,34,22,34,26,43,26,43,43,66,43,66,26,43,26,43,43,66,43,66,14,22,14,22,22,34,22,34,14,22,14,22,22,34,22,34,                                                                                                                                         
29,46,29,46,46,74,46,74,29,46,29,46,46,74,46,74,15,24,15,24,24,39,24,39,15,24,15,24,24,39,24,39,29,46,29,46,46,74,46,74,29,46,29,46,46,74,46,74,15,24,15,24,24,39,24,39,15,24,15,24,24,39,24,39,                                                                                                                                         
47,75,47,75,75,119,75,119,47,75,47,75,75,119,75,119,25,40,25,40,40,62,40,62,25,40,25,40,40,62,40,62,47,75,47,75,75,119,75,119,47,75,47,75,75,119,75,119,25,40,25,40,40,62,40,62,25,40,25,40,40,62,40,62,                                                                                                                                 
52,85,52,85,85,131,85,131,52,85,52,85,85,131,85,131,27,45,27,45,45,69,45,69,27,45,27,45,45,69,45,69,52,85,52,85,85,131,85,131,52,85,52,85,85,131,85,131,27,45,27,45,45,69,45,69,27,45,27,45,45,69,45,69,                                                                                                                                 
58,92,58,92,92,147,92,147,58,92,58,92,92,147,92,147,30,48,30,48,48,77,48,77,30,48,30,48,48,77,48,77,58,92,58,92,92,147,92,147,58,92,58,92,92,147,92,147,30,48,30,48,48,77,48,77,30,48,30,48,48,77,48,77,                                                                                                                                 
68,105,68,105,105,164,105,164,68,105,68,105,105,164,105,164,36,55,36,55,55,86,55,86,36,55,36,55,55,86,55,86,68,105,68,105,105,164,105,164,68,105,68,105,105,164,105,164,36,55,36,55,55,86,55,86,36,55,36,55,55,86,55,86,                                                                                                                 
73,118,73,118,118,189,118,189,73,118,73,118,118,189,118,189,38,62,38,62,62,99,62,99,38,62,38,62,62,99,62,99,73,118,73,118,118,189,118,189,73,118,73,118,118,189,118,189,38,62,38,62,62,99,62,99,38,62,38,62,62,99,62,99,                                                                                                                 
136,211,136,211,211,326,211,326,136,211,136,211,211,326,211,326,71,110,71,110,110,171,110,171,71,110,71,110,110,171,110,171,136,211,136,211,211,326,211,326,136,211,136,211,211,326,211,326,71,110,71,110,110,171,110,171,71,110,71,110,110,171,110,171,
147,236,147,236,236,377,236,377,147,236,147,236,236,377,236,377,77,124,77,124,124,198,124,198,77,124,77,124,124,198,124,198,147,236,147,236,236,377,236,377,147,236,147,236,236,377,236,377,77,124,77,124,124,198,124,198,77,124,77,124,124,198,124,198,
84,131,84,131,131,205,131,205,84,131,84,131,131,205,131,205,44,69,44,69,69,107,69,107,44,69,44,69,69,107,69,107,84,131,84,131,131,205,131,205,84,131,84,131,131,205,131,205,44,69,44,69,69,107,69,107,44,69,44,69,69,107,69,107,                                                                                                         
94,151,94,151,151,239,151,239,94,151,94,151,151,239,151,239,49,79,49,79,79,125,79,125,49,79,49,79,79,125,79,125,94,151,94,151,151,239,151,239,94,151,94,151,151,239,151,239,49,79,49,79,79,125,79,125,49,79,49,79,79,125,79,125,
105,171,105,171,171,262,171,262,105,171,105,171,171,262,171,262,55,89,55,89,89,137,89,137,55,89,55,89,89,137,89,137,105,171,105,171,171,262,171,262,105,171,105,171,171,262,171,262,55,89,55,89,89,137,89,137,55,89,55,89,89,137,89,137,
116,184,116,184,184,295,184,295,116,184,116,184,184,295,184,295,61,96,61,96,96,154,96,154,61,96,61,96,96,154,96,154,116,184,116,184,184,295,184,295,116,184,116,184,184,295,184,295,61,96,61,96,96,154,96,154,61,96,61,96,96,154,96,154,
231,364,231,364,364,597,364,597,231,364,231,364,364,597,364,597,121,191,121,191,191,313,191,313,121,191,121,191,191,313,191,313,231,364,231,364,364,597,364,597,231,364,231,364,364,597,364,597,121,191,121,191,191,313,191,313,121,191,121,191,191,313,191,313,
272,422,272,422,422,652,422,652,272,422,272,422,422,652,422,652,143,221,143,221,221,341,221,341,143,221,143,221,221,341,221,341,272,422,272,422,422,652,422,652,272,422,272,422,422,652,422,652,143,221,143,221,221,341,221,341,143,221,143,221,221,341,221,341,
168,262,168,262,262,414,262,414,168,262,168,262,262,414,262,414,88,137,88,137,137,217,137,217,88,137,88,137,137,217,137,217,168,262,168,262,262,414,262,414,168,262,168,262,262,414,262,414,88,137,88,137,137,217,137,217,88,137,88,137,137,217,137,217,
189,303,189,303,303,478,303,478,189,303,189,303,303,478,303,478,99,159,99,159,159,250,159,250,99,159,99,159,159,250,159,250,189,303,189,303,303,478,303,478,189,303,189,303,303,478,303,478,99,159,99,159,159,250,159,250,99,159,99,159,159,250,159,250,
211,341,211,341,341,524,341,524,211,341,211,341,341,524,341,524,110,179,110,179,179,275,179,275,110,179,110,179,179,275,179,275,211,341,211,341,341,524,341,524,211,341,211,341,341,524,341,524,110,179,110,179,179,275,179,275,110,179,110,179,179,275,179,275,
295,467,295,467,467,768,467,768,295,467,295,467,467,768,467,768,154,245,154,245,245,402,245,402,154,245,154,245,245,402,245,402,295,467,295,467,467,768,467,768,295,467,295,467,467,768,467,768,154,245,154,245,245,402,245,402,154,245,154,245,245,402,245,402
};


#define hct4x4(buf1, buf2) \
        buf2[0] = buf1[0]; \
        buf2[1] = buf1[1]; \
        buf2[2] = buf1[2]; \
        buf2[3] = buf1[3]; \
        buf2[4] = buf1[4]; \
        buf2[5] = buf1[5]; \
        buf2[6] = buf1[6]; \
        buf2[7] = buf1[7]; \
        buf2[8] = buf1[8]; \
        buf2[9] = buf1[9]; \
        buf2[10] = buf1[10]; \
        buf2[11] = buf1[11]; \
        buf2[12] = buf1[12]; \
        buf2[13] = buf1[13]; \
        buf2[14] = buf1[14]; \
        buf2[15] = buf1[15]; \
        buf2[16] = ((buf2[1])) + ((buf2[2])); \
        buf2[17] = ((buf2[0])) + ((buf2[3])); \
        buf2[18] = ((buf2[4])) + ((buf2[7])); \
        buf2[19] = ((buf2[5])) + ((buf2[6])); \
        buf2[20] = ((buf2[8])) + ((buf2[11])); \
        buf2[21] = ((buf2[9])) + ((buf2[10])); \
        buf2[22] = (-(buf2[13])) + (-(buf2[14])); \
        buf2[23] = ((buf2[12])) + ((buf2[15])); \
        buf2[24] = ((buf2[1])) + (-(buf2[2])); \
        buf2[25] = ((buf2[0])) + (-(buf2[3])); \
        buf2[26] = (-(buf2[4])) + ((buf2[7])); \
        buf2[27] = (-(buf2[5])) + ((buf2[6])); \
        buf2[28] = ((buf2[9])) + (-(buf2[10])); \
        buf2[29] = ((buf2[8])) + (-(buf2[11])); \
        buf2[30] = ((buf2[12])) + (-(buf2[15])); \
        buf2[31] = ((buf2[13])) + (-(buf2[14])); \
        buf2[32] = ((buf2[16])) + ((buf2[17])); \
        buf2[33] = ((buf2[18])) + ((buf2[19])); \
        buf2[34] = (-(buf2[16])) + ((buf2[17])); \
        buf2[35] = (-(buf2[18])) + ((buf2[19])); \
        buf2[36] = (-(buf2[20])) + ((buf2[21])); \
        buf2[37] = (-(buf2[22])) + ((buf2[23])); \
        buf2[38] = (-(buf2[20])) + (-(buf2[21])); \
        buf2[39] = ((buf2[22])) + ((buf2[23])); \
        buf2[40] = (-(buf2[26])) + ((buf2[27] << 1)); \
        buf2[41] = (-(buf2[26] << 1)) + (-(buf2[27])); \
        buf2[42] = (-(buf2[24] << 1)) + ((buf2[25])); \
        buf2[43] = ((buf2[24])) + ((buf2[25] << 1)); \
        buf2[44] = ((buf2[28])) + ((buf2[29] << 1)); \
        buf2[45] = ((buf2[30])) + (-(buf2[31] << 1)); \
        buf2[46] = ((buf2[28] << 1)) + (-(buf2[29])); \
        buf2[47] = ((buf2[30] << 1)) + ((buf2[31])); \
        buf2[48] = (-(buf2[33])) + (-(buf2[38])); \
        buf2[49] = ((buf2[33])) + (-(buf2[38])); \
        buf2[50] = (-(buf2[35])) + (-(buf2[36])); \
        buf2[51] = ((buf2[40])) + (-(buf2[46])); \
        buf2[52] = (-(buf2[41])) + (-(buf2[44])); \
        buf2[53] = ((buf2[43])) + ((buf2[47])); \
        buf2[54] = ((buf2[34])) + ((buf2[39])); \
        buf2[55] = ((buf2[32])) + ((buf2[37])); \
        buf2[56] = ((buf2[35])) + (-(buf2[36])); \
        buf2[57] = ((buf2[34])) + (-(buf2[39])); \
        buf2[58] = ((buf2[42])) + ((buf2[45])); \
        buf2[59] = ((buf2[32])) + (-(buf2[37])); \
        buf1[0] = ((buf2[49])) + ((buf2[55])); \
        buf1[1] = quant((-(buf2[52])) + ((buf2[53])), qual, 1, 1); \
        buf1[2] = quant(((buf2[50])) + ((buf2[54])), qual, 2, 1); \
        buf1[3] = quant(((buf2[51])) + ((buf2[58])), qual, 3, 1); \
        buf1[4] = quant((-(buf2[48])) + ((buf2[59] << 1)), qual, 4, 1); \
        buf1[5] = quant(((buf2[0] << 2)) + (-(buf2[3] << 2)) + (-(buf2[12] << 2)) + ((buf2[15] << 2)) + ((buf2[24] << 1)) + (-(buf2[31] << 1)) + ((buf2[41])) + (-(buf2[44])), qual, 5, 1); \
        buf1[6] = quant((-(buf2[56])) + ((buf2[57] << 1)), qual, 6, 1); \
        buf1[7] = quant((-(buf2[1] << 2)) + ((buf2[2] << 2)) + ((buf2[13] << 2)) + (-(buf2[14] << 2)) + ((buf2[25] << 1)) + (-(buf2[30] << 1)) + ((buf2[40])) + ((buf2[46])), qual, 7, 1); \
        buf1[8] = quant((-(buf2[49])) + ((buf2[55])), qual, 8, 1); \
        buf1[9] = quant(((buf2[52])) + ((buf2[53])), qual, 9, 1); \
        buf1[10] = quant((-(buf2[50])) + ((buf2[54])), qual, 10, 1); \
        buf1[11] = quant((-(buf2[51])) + ((buf2[58])), qual, 11, 1); \
        buf1[12] = quant(((buf2[48] << 1)) + ((buf2[59])), qual, 12, 1); \
        buf1[13] = quant((-(buf2[4] << 2)) + ((buf2[7] << 2)) + ((buf2[8] << 2)) + (-(buf2[11] << 2)) + ((buf2[27] << 1)) + ((buf2[28] << 1)) + ((buf2[43])) + (-(buf2[47])), qual, 13, 1); \
        buf1[14] = quant(((buf2[56] << 1)) + ((buf2[57])), qual, 14, 1); \
        buf1[15] = quant(((buf2[5] << 2)) + (-(buf2[6] << 2)) + (-(buf2[9] << 2)) + ((buf2[10] << 2)) + ((buf2[26] << 1)) + ((buf2[29] << 1)) + ((buf2[42])) + (-(buf2[45])), qual, 15, 1); \
;

#define ihct4x4(buf1, buf2) \
        buf2[0] = ((dequant(buf1[1], qual, 1, 1) << 2)) + ((dequant(buf1[3], qual, 3, 1) << 1)); \
        buf2[1] = ((buf1[0] << 2)) + ((dequant(buf1[2], qual, 2, 1) << 2)); \
        buf2[2] = ((dequant(buf1[1], qual, 1, 1) << 1)) + (-(dequant(buf1[3], qual, 3, 1) << 2)); \
        buf2[3] = ((buf1[0] << 2)) + (-(dequant(buf1[2], qual, 2, 1) << 2)); \
        buf2[4] = (-(dequant(buf1[4], qual, 4, 1) << 1)) + (-(dequant(buf1[6], qual, 6, 1) << 1)); \
        buf2[5] = ((dequant(buf1[4], qual, 4, 1) << 1)) + (-(dequant(buf1[6], qual, 6, 1) << 1)); \
        buf2[6] = ((dequant(buf1[5], qual, 5, 1) << 1)) + ((dequant(buf1[7], qual, 7, 1))); \
        buf2[7] = ((dequant(buf1[5], qual, 5, 1))) + (-(dequant(buf1[7], qual, 7, 1) << 1)); \
        buf2[8] = ((dequant(buf1[9], qual, 9, 1) << 2)) + ((dequant(buf1[11], qual, 11, 1) << 1)); \
        buf2[9] = (-(dequant(buf1[8], qual, 8, 1) << 2)) + ((dequant(buf1[10], qual, 10, 1) << 2)); \
        buf2[10] = ((dequant(buf1[8], qual, 8, 1) << 2)) + ((dequant(buf1[10], qual, 10, 1) << 2)); \
        buf2[11] = ((dequant(buf1[9], qual, 9, 1) << 1)) + (-(dequant(buf1[11], qual, 11, 1) << 2)); \
        buf2[12] = (-(dequant(buf1[12], qual, 12, 1) << 1)) + (-(dequant(buf1[14], qual, 14, 1) << 1)); \
        buf2[13] = ((dequant(buf1[12], qual, 12, 1) << 1)) + (-(dequant(buf1[14], qual, 14, 1) << 1)); \
        buf2[14] = ((dequant(buf1[13], qual, 13, 1))) + (-(dequant(buf1[15], qual, 15, 1) << 1)); \
        buf2[15] = (-(dequant(buf1[13], qual, 13, 1) << 1)) + (-(dequant(buf1[15], qual, 15, 1))); \
        buf2[16] = (-(buf2[4])) + (-(buf2[6])); \
        buf2[17] = ((buf2[4])) + (-(buf2[6])); \
        buf2[18] = ((buf2[2])) + ((buf2[3])); \
        buf2[19] = (-(buf2[2])) + ((buf2[3])); \
        buf2[20] = (-(buf2[0])) + ((buf2[1])); \
        buf2[21] = ((buf2[0])) + ((buf2[1])); \
        buf2[22] = ((buf2[5])) + (-(buf2[7])); \
        buf2[23] = (-(buf2[5])) + (-(buf2[7])); \
        buf2[24] = (-(buf2[13])) + (-(buf2[14])); \
        buf2[25] = ((buf2[8])) + ((buf2[10])); \
        buf2[26] = (-(buf2[8])) + ((buf2[10])); \
        buf2[27] = ((buf2[12])) + ((buf2[15])); \
        buf2[28] = (-(buf2[12])) + ((buf2[15])); \
        buf2[29] = ((buf2[9])) + (-(buf2[11])); \
        buf2[30] = (-(buf2[13])) + ((buf2[14])); \
        buf2[31] = (-(buf2[9])) + (-(buf2[11])); \
        buf2[32] = ((buf2[19])) + (-(buf2[31])); \
        buf2[33] = ((buf2[17] << 1)) + ((buf2[27])); \
        buf2[34] = ((buf2[20])) + (-(buf2[26])); \
        buf2[35] = ((buf2[21])) + (-(buf2[25])); \
        buf2[36] = ((buf2[17])) + (-(buf2[27] << 1)); \
        buf2[37] = (-(buf2[16] << 1)) + (-(buf2[28])); \
        buf2[38] = ((buf2[23] << 1)) + ((buf2[24])); \
        buf2[39] = ((buf2[23])) + (-(buf2[24] << 1)); \
        buf2[40] = ((buf2[20])) + ((buf2[26])); \
        buf2[41] = (-(buf2[22] << 1)) + ((buf2[30])); \
        buf2[42] = ((buf2[19])) + ((buf2[31])); \
        buf2[43] = ((buf2[18])) + (-(buf2[29])); \
        buf2[44] = ((buf2[16])) + (-(buf2[28] << 1)); \
        buf2[45] = (-(buf2[22])) + (-(buf2[30] << 1)); \
        buf2[46] = ((buf2[18])) + ((buf2[29])); \
        buf2[47] = ((buf2[21])) + ((buf2[25])); \
        buf1[0] = ((-(buf2[33])) + ((buf2[47])) + 128) >> 8; \
        buf1[1] = ((-(buf2[38])) + ((buf2[43])) + 128) >> 8; \
        buf1[2] = ((-(buf2[41])) + ((buf2[42])) + 128) >> 8; \
        buf1[3] = ((-(buf2[37])) + ((buf2[40])) + 128) >> 8; \
        buf1[4] = (((buf2[35])) + (-(buf2[36])) + 128) >> 8; \
        buf1[5] = ((-(buf2[39])) + ((buf2[46])) + 128) >> 8; \
        buf1[6] = (((buf2[32])) + (-(buf2[45])) + 128) >> 8; \
        buf1[7] = (((buf2[34])) + ((buf2[44])) + 128) >> 8; \
        buf1[8] = (((buf2[35])) + ((buf2[36])) + 128) >> 8; \
        buf1[9] = (((buf2[39])) + ((buf2[46])) + 128) >> 8; \
        buf1[10] = (((buf2[32])) + ((buf2[45])) + 128) >> 8; \
        buf1[11] = (((buf2[34])) + (-(buf2[44])) + 128) >> 8; \
        buf1[12] = (((buf2[33])) + ((buf2[47])) + 128) >> 8; \
        buf1[13] = (((buf2[38])) + ((buf2[43])) + 128) >> 8; \
        buf1[14] = (((buf2[41])) + ((buf2[42])) + 128) >> 8; \
        buf1[15] = (((buf2[37])) + ((buf2[40])) + 128) >> 8; \
;

int quant(int val, int qual, int index, int block_cat)
{
  int coef;

  int bias = bias_table[(qual-0)*16*4 + block_cat*16 + index];
  int mult_coef = quant_table[(qual-0)*16*4 + block_cat*16 + index];
  int coef1 = ((bias + (val)) * (mult_coef)) >> 16;
  int coef2 = - (((bias - (val)) * (mult_coef)) >> 16);

  coef = val > 0 ? coef1 : coef2;

  return coef;
}


int dequant(int val, int qual, int index, int block_cat)
{
  int coef;
  const int i_mf = qual%6;
  int mult_coef = dequant_table[i_mf*16*4 + block_cat*16 + index];

  const int i_qbits = qual/6 - 4;
  const int f = 1 << (-i_qbits-1);

  val = val * mult_coef;

  int ret1 = val << i_qbits;
  int ret2 = (val + f) >> (-i_qbits);

  coef = i_qbits >= 0 ? ret1 : ret2;

  return coef;
}


kernel void hct_4x4_v3(global int* buffer1, global int*buffer2, int buffer_size)
{
  int qual=25;
  int tmp[64];
  int buffer[16];
  
  for (int i = 0; i < 16; i++)
  {
    buffer[i] = buffer1[get_global_id(0)+i*512];
  }

  for (int i = 0; i < 16; i++)
  {
    hct4x4(buffer, tmp);
    buffer[0] = quant(buffer[0], qual, 0, 1);
    
    for (int j = 0; j < 16; j++)
    {
      buffer2[get_global_id(0)+(16+j+i*16)*512] = buffer[j];
    }
    
    buffer[0] = dequant(buffer[0], qual, 0, 1); 
    ihct4x4(buffer, tmp);
  }
  
  for (int i = 0; i < 16; i++)
  {
    buffer2[get_global_id(0)+i*512] = buffer[i];
  }
}

//Gold

#ifndef __OPENCL_VERSION__

void hct_4x4_v3(void* buffer1, void* buffer2, int buffer_size)
{
  for (int i = 0; i <  buffer_size; i++)
  {
    int val = ((int*)buffer1)[i];
    throw "TODO";
    ((int*)buffer2)[i] = val;
  }
}

#endif